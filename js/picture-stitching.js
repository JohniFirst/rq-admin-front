import{r as m,j as a,b as E,C as f,B as h}from"./index.js";import{R as I}from"./DeleteOutlined.js";import{S as L}from"./index3.js";function F(){const d=m.useRef(null),[o,l]=m.useState([]),[g,j]=m.useState("");function y(t){l([...o,URL.createObjectURL(t.target.files[0])])}const w=()=>{const t=document.createElement("canvas"),r=t.getContext("2d"),s=d.current.getElementsByTagName("img"),c=Array.from(s).map(e=>({width:e.naturalWidth,height:e.naturalHeight,scaleFactor:0})),p=Math.min(...c.map(e=>e.width));Array.from(s).forEach((e,n)=>{c[n].scaleFactor=p/e.naturalWidth}),t.width=p;const R=c.reduce((e,n,i)=>e+n.height*c[i].scaleFactor,0);t.height=R,r.clearRect(0,0,t.width,t.height);let u=0;for(let e=0,n=s.length;e<n;e++){const i=c[e].scaleFactor,x=s[e].naturalHeight,S=s[e].naturalWidth*i,k=x*i;r.drawImage(s[e],0,u,S,k),u+=x*i}j(t.toDataURL("image/png"))},C=()=>{const t=document.createElement("a");t.download="picture-stitching.png",t.href=g,t.click()};return a.jsxs(E,{className:"custom-container",children:[a.jsxs(f,{span:12,children:[a.jsx("input",{type:"file",accept:"image/*",onChange:y}),a.jsx("p",{children:a.jsx(h,{type:"primary",onClick:()=>l([]),children:"清空"})}),a.jsx("div",{className:"max-w-[400px] border-2",ref:d,children:o.map(t=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{className:"img-tocopy",src:t,alt:"上传的图片",width:"100%"}),a.jsx(I,{className:"img-del-btn",onClick:()=>l(o.filter(r=>r!==t))})]},t))})]}),a.jsxs(f,{span:12,children:[a.jsxs(L,{size:"middle",children:[a.jsx(h,{type:"primary",onClick:w,children:"复制"}),a.jsx(h,{onClick:C,children:"下载"})]}),a.jsx("img",{src:g,alt:"复制后的图片"})]})]})}export{F as default};
